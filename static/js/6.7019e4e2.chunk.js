(this["webpackJsonpway-of-samurai"]=this["webpackJsonpway-of-samurai"]||[]).push([[6],{101:function(e,a,t){"use strict";t.d(a,"a",(function(){return f}));var s=t(40),n=t(39),r=t(16),o=t(0),l=t.n(o),i=t(110),c=t.n(i),m=t(100),u=t(20),g=t.n(u),d=t(129),p=t.n(d),f=function(e){var a=e.label,t=e.fieldType,i=Object(r.a)(e,["label","fieldType"]),u=Object(m.d)(i),d=Object(n.a)(u,2),f=d[0],h=d[1];return Object(o.useEffect)((function(){var e;e=document.getElementsByClassName(c.a.simpleInput),"textarea"===t&&p()(e)})),l.a.createElement("div",{className:c.a.inputBox},!!a&&"checkbox"!==t&&l.a.createElement("label",{htmlFor:i.id||i.name},a),"checkbox"!==t&&l.a.createElement(m.a,Object.assign({rows:1,as:t,className:c.a.simpleInput},f,i)),"checkbox"===t&&l.a.createElement("div",{className:c.a.checkboxInput},l.a.createElement(m.a,Object.assign({type:"checkbox",checked:f.value},f,i)),l.a.createElement("label",{htmlFor:i.id||i.name},a)),!!i.maxLength&&l.a.createElement("div",{className:g()(c.a.maxLength,Object(s.a)({},c.a.error,f.value.length>=i.maxLength))},f.value.length,"/",i.maxLength),h.error&&h.touched?l.a.createElement("div",{className:c.a.fieldError},h.error):null)}},102:function(e,a,t){"use strict";var s=t(0),n=t.n(s),r=t(111),o=t.n(r),l=t(41),i=t.n(l);a.a=function(){return n.a.createElement("div",{className:o.a.preloader},n.a.createElement("img",{src:i.a,alt:"preloader"}))}},110:function(e,a,t){e.exports={inputBox:"CustomFormControls_inputBox__2M9DM",simpleInput:"CustomFormControls_simpleInput__3R0RT",maxLength:"CustomFormControls_maxLength__1jqRO",error:"CustomFormControls_error__bVcUE",fieldError:"CustomFormControls_fieldError__MVOSL",checkboxInput:"CustomFormControls_checkboxInput__xnNWt"}},111:function(e,a,t){e.exports={preloader:"PreloaderSmall_preloader__Yd-fv"}},179:function(e,a,t){e.exports={dialogs:"Dialogs_dialogs__azdOc",showDialogsList:"Dialogs_showDialogsList__17vwK",dialogsContainer:"Dialogs_dialogsContainer__1N79k",dialogsList:"Dialogs_dialogsList__3HEzI",messagesList:"Dialogs_messagesList__2HwY3",sendMessageBlock:"Dialogs_sendMessageBlock__2OxWB",noDialogMessage:"Dialogs_noDialogMessage__MvAt8"}},180:function(e,a,t){e.exports={dialog:"Dialog_dialog__2dEEq",user:"Dialog_user__2rFFt",active:"Dialog_active__2dkw_"}},181:function(e,a,t){e.exports={message:"Message_message__2LqB3",messageInnerContainer:"Message_messageInnerContainer__eXKYE",messageFrom:"Message_messageFrom__1V-4M",time:"Message_time__Hvkbo",myMessage:"Message_myMessage__YwGM2"}},182:function(e,a,t){e.exports=t.p+"static/media/send-message_white.147a79aa.svg"},183:function(e,a,t){e.exports=t.p+"static/media/arrow-left.55da2725.svg"},195:function(e,a,t){"use strict";t.r(a);var s=t(25),n=t(26),r=t(28),o=t(27),l=t(13),i=t(16),c=t(0),m=t.n(c),u=t(179),g=t.n(u),d=t(180),p=t.n(d),f=t(9),h=t(102),_=m.a.memo((function(e){var a=e.userId,t=e.user;Object(i.a)(e,["userId","user"]);return m.a.createElement("div",{className:p.a.dialog},m.a.createElement(f.b,{to:"/dialogs/"+a,activeClassName:p.a.active,className:p.a.user},!!t&&m.a.createElement(m.a.Fragment,null,m.a.createElement("img",{src:t.photos&&t.photos.small,alt:t.fullName}),m.a.createElement("span",null,t.fullName)),!t&&m.a.createElement(h.a,null)))})),E=t(40),b=t(181),v=t.n(b),N=t(20),y=t.n(N),x=m.a.memo((function(e){var a=e.messageText,t=e.from,s=e.time,n=(e.dialogId,e.opponent),r=(Object(i.a)(e,["messageText","from","time","dialogId","opponent"]),"opponent:");return n.fullName&&(r=n.fullName+":"),m.a.createElement("div",{className:y()(v.a.message,Object(E.a)({},v.a.myMessage,"me"===t))},m.a.createElement("div",{className:v.a.messageInnerContainer},m.a.createElement("div",{className:v.a.messageFrom},"me"===t?"me:":r),m.a.createElement("div",{className:v.a.messageText},a),m.a.createElement("div",{className:v.a.time},function(e){var a=new Date(e);return a.getHours()+":"+("0"+a.getMinutes()).substr(-2)}(s))))})),D=t(101),I=t(100),C=t(182),O=t.n(C),M=t(183),j=t.n(M),k=m.a.memo((function(e){var a=e.dialogs,t=e.messages,s=e.users,n=e.sendMessage,r=e.currentUser,o=(Object(i.a)(e,["dialogs","messages","users","sendMessage","currentUser"]),function(){document.getElementById("dialogsScrollToRef").scrollTo(0,document.getElementById("dialogsScrollToRef").scrollHeight)});return Object(c.useEffect)((function(){o()})),m.a.createElement("div",{className:g.a.dialogs},m.a.createElement("div",{onClick:function(){document.getElementsByClassName(g.a.dialogsList)[0].style.left=0,document.getElementsByClassName(g.a.showDialogsList)[0].style.left="200%"},className:g.a.showDialogsList},m.a.createElement("img",{src:j.a,alt:"show dialogs"}),m.a.createElement("span",null,"Show other conversations")),m.a.createElement("div",{id:"dialogsScrollToRef",className:g.a.dialogsContainer},m.a.createElement("div",{onClick:function(){document.getElementsByClassName(g.a.dialogsList)[0].style.left="-100%",document.getElementsByClassName(g.a.showDialogsList)[0].style.left=0},className:g.a.dialogsList},a.map((function(e){var a=Object(l.a)(s),t="";return a.forEach((function(a){a.userId===e.opponentId&&(t=a)})),m.a.createElement(_,{key:e.id,user:t,userId:e.opponentId,currentUser:r})}))),m.a.createElement("div",{className:g.a.messagesList},t.map((function(e){if(e.dialogId===r){var a=Object(l.a)(s),t="";return a.forEach((function(e){e.userId===r&&(t=e)})),m.a.createElement(x,{key:e.id,messageId:e.id,opponent:t,from:e.from,messageText:e.messageText,dialogId:e.dialogId,time:e.time})}return null}))),!!r&&m.a.createElement(I.c,{initialValues:{message:""},onSubmit:function(e,a){e.message.length>0&&new Promise((function(a,t){return n(r,e.message,Date.now()),o(),a(null)})).then((function(){a.resetForm({message:""})})).catch((function(e){a.setFieldError("general",e)}))}},(function(e){return m.a.createElement(I.b,{className:g.a.sendMessageBlock},m.a.createElement(D.a,{name:"message",fieldType:"textarea",placeholder:'Type something besides "ghbdtn" ;) ',onKeyDown:function(a){"Enter"===a.key&&(a.shiftKey||(a.preventDefault(),e.handleSubmit()))}}),m.a.createElement("button",{type:"submit",className:y()("button","button-success")},m.a.createElement("img",{src:O.a,alt:"send message"})))})),!r&&m.a.createElement("div",{className:g.a.noDialogMessage},m.a.createElement("span",null,"Choose user to start conversation"))))})),w=t(54),L=t(21),F=t(4),B=function(e){return{isAuth:e.auth.isAuth}},T=t(14),U=function(e){return e.dialogsPage.messages},S=function(e){return e.dialogsPage.dialogs},P=function(e){return e.dialogsPage.users},R=function(e){Object(r.a)(t,e);var a=Object(o.a)(t);function t(){var e;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={currentUser:Number(e.props.match.params.userId),users:e.props.users},e.refreshDialogs=function(){var a=Number(e.props.match.params.userId);e.setState({currentUser:a})},e.getUsersFromDialogs=function(a){a.forEach((function(a){a.opponentId&&e.props.getUserFromServer(a.opponentId)}))},e}return Object(n.a)(t,[{key:"componentDidMount",value:function(){this.refreshDialogs(),this.getUsersFromDialogs(this.props.dialogs)}},{key:"componentDidUpdate",value:function(){this.refreshDialogs()}},{key:"render",value:function(){return m.a.createElement(k,{currentUser:this.state.currentUser,dialogs:this.props.dialogs,messages:this.props.messages,users:this.props.users,sendMessage:this.props.sendMessage})}}]),t}(m.a.PureComponent);a.default=Object(T.d)(Object(L.b)((function(e){return{dialogs:S(e),messages:U(e),users:P(e)}}),{sendMessage:w.c,getUserFromServer:w.b}),F.g,(function(e){var a=function(a){Object(r.a)(l,a);var t=Object(o.a)(l);function l(){return Object(s.a)(this,l),t.apply(this,arguments)}return Object(n.a)(l,[{key:"render",value:function(){return this.props.isAuth?m.a.createElement(e,this.props):m.a.createElement(F.a,{to:"/login"})}}]),l}(m.a.Component);return Object(L.b)(B)(a)}))(R)}}]);
//# sourceMappingURL=6.7019e4e2.chunk.js.map